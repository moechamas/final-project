{"ast":null,"code":"const {\n  promisify\n} = require('util');\nconst {\n  get: getClient\n} = require('../../client');\n\n// Default hook that checks if the user has been logged out via Back-Channel Logout\nmodule.exports = async (req, config) => {\n  const store = config.backchannelLogout && config.backchannelLogout.store || config.session.store;\n  const get = promisify(store.get).bind(store);\n  const {\n    issuer: {\n      issuer\n    }\n  } = await getClient(config);\n  const {\n    sid,\n    sub\n  } = req.oidc.idTokenClaims;\n  if (!sid && !sub) {\n    throw new Error(`The session must have a 'sid' or a 'sub'`);\n  }\n  const [logoutSid, logoutSub] = await Promise.all([sid && get(`${issuer}|${sid}`), sub && get(`${issuer}|${sub}`)]);\n  return !!(logoutSid || logoutSub);\n};","map":{"version":3,"names":["promisify","require","get","getClient","module","exports","req","config","store","backchannelLogout","session","bind","issuer","sid","sub","oidc","idTokenClaims","Error","logoutSid","logoutSub","Promise","all"],"sources":["/Users/chamas/Final-Project/final-project/node_modules/express-openid-connect/lib/hooks/backchannelLogout/isLoggedOut.js"],"sourcesContent":["const { promisify } = require('util');\nconst { get: getClient } = require('../../client');\n\n// Default hook that checks if the user has been logged out via Back-Channel Logout\nmodule.exports = async (req, config) => {\n  const store =\n    (config.backchannelLogout && config.backchannelLogout.store) ||\n    config.session.store;\n  const get = promisify(store.get).bind(store);\n  const {\n    issuer: { issuer },\n  } = await getClient(config);\n  const { sid, sub } = req.oidc.idTokenClaims;\n  if (!sid && !sub) {\n    throw new Error(`The session must have a 'sid' or a 'sub'`);\n  }\n  const [logoutSid, logoutSub] = await Promise.all([\n    sid && get(`${issuer}|${sid}`),\n    sub && get(`${issuer}|${sub}`),\n  ]);\n  return !!(logoutSid || logoutSub);\n};\n"],"mappings":"AAAA,MAAM;EAAEA;AAAU,CAAC,GAAGC,OAAO,CAAC,MAAM,CAAC;AACrC,MAAM;EAAEC,GAAG,EAAEC;AAAU,CAAC,GAAGF,OAAO,CAAC,cAAc,CAAC;;AAElD;AACAG,MAAM,CAACC,OAAO,GAAG,OAAOC,GAAG,EAAEC,MAAM,KAAK;EACtC,MAAMC,KAAK,GACRD,MAAM,CAACE,iBAAiB,IAAIF,MAAM,CAACE,iBAAiB,CAACD,KAAK,IAC3DD,MAAM,CAACG,OAAO,CAACF,KAAK;EACtB,MAAMN,GAAG,GAAGF,SAAS,CAACQ,KAAK,CAACN,GAAG,CAAC,CAACS,IAAI,CAACH,KAAK,CAAC;EAC5C,MAAM;IACJI,MAAM,EAAE;MAAEA;IAAO;EACnB,CAAC,GAAG,MAAMT,SAAS,CAACI,MAAM,CAAC;EAC3B,MAAM;IAAEM,GAAG;IAAEC;EAAI,CAAC,GAAGR,GAAG,CAACS,IAAI,CAACC,aAAa;EAC3C,IAAI,CAACH,GAAG,IAAI,CAACC,GAAG,EAAE;IAChB,MAAM,IAAIG,KAAK,CAAE,0CAAyC,CAAC;EAC7D;EACA,MAAM,CAACC,SAAS,EAAEC,SAAS,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CAC/CR,GAAG,IAAIX,GAAG,CAAE,GAAEU,MAAO,IAAGC,GAAI,EAAC,CAAC,EAC9BC,GAAG,IAAIZ,GAAG,CAAE,GAAEU,MAAO,IAAGE,GAAI,EAAC,CAAC,CAC/B,CAAC;EACF,OAAO,CAAC,EAAEI,SAAS,IAAIC,SAAS,CAAC;AACnC,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}